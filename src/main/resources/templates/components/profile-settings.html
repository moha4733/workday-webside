<!DOCTYPE html>
<html lang="da" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Profil | Workday</title>
    <link rel="stylesheet" th:href="@{/css/admin/admin.css}">
    <style>
        .profile-container {
            max-width: 600px;
            margin: 40px auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .profile-photo-preview {
            text-align: center;
            margin-bottom: 30px;
        }

        .profile-photo-preview img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #007bff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .profile-photo-preview .placeholder {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 48px;
            font-weight: bold;
            border: 4px solid #007bff;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input[type="file"] {
            width: 100%;
            padding: 10px;
            border: 2px dashed #ddd;
            border-radius: 4px;
            cursor: pointer;
        }

        .alert {
            padding: 12px 20px;
            border-radius: 4px;
            margin-bottom: 20px;
        }

        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .user-info {
            text-align: center;
            margin-bottom: 30px;
        }

        .user-info h2 {
            margin: 10px 0 5px 0;
            color: #333;
        }

        .user-info p {
            color: #666;
            margin: 0;
        }
    </style>
</head>

<body>
    <div class="dashboard-wrapper">
        <nav class="sidebar">
            <h2>Workday</h2>
            <ul>
                <li th:if="${user.role.name() == 'ADMIN'}">
                    <a th:href="@{/admin/dashboard}">Oversigt</a>
                </li>
                <li th:if="${user.role.name() == 'SVEND'}">
                    <a th:href="@{/svend/dashboard}">Oversigt</a>
                </li>
                <li><a th:href="@{/profile}" class="active">Profil</a></li>
                <li><a th:href="@{/logout}" class="logout">Log ud</a></li>
            </ul>
        </nav>

        <main class="main-content">
            <header>
                <h1>Min Profil</h1>
            </header>

            <div class="profile-container">
                <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
                <div th:if="${error}" class="alert alert-error" th:text="${error}"></div>

                <div class="user-info">
                    <h2 th:text="${user.name}">Navn</h2>
                    <p th:text="${user.email}">email@example.com</p>
                </div>

                <div class="profile-photo-preview">
                    <img th:if="${user.profilePhotoPath != null}"
                        th:src="@{'/uploads/profiles/' + ${user.profilePhotoPath}}" alt="Profilbillede">
                    <div th:unless="${user.profilePhotoPath != null}" class="placeholder"
                        th:text="${user.name.substring(0,1).toUpperCase()}">
                    </div>
                </div>

                <form th:action="@{/profile/photo}" method="post" enctype="multipart/form-data">
                    <input th:if="${_csrf != null}" type="hidden" th:name="${_csrf.parameterName}"
                        th:value="${_csrf.token}" />

                    <div class="form-group">
                        <label for="photo">Upload nyt profilbillede</label>
                        <input type="file" id="photo" name="photo" accept="image/*" required>
                        <small style="color: #666; display: block; margin-top: 5px;">
                            Understøttede formater: JPG, PNG, GIF (maks 5MB)
                        </small>
                    </div>

                    <div class="btn-group">
                        <button type="submit" class="btn-primary">Upload billede</button>
                        <a th:if="${user.profilePhotoPath != null}" 
                           th:href="@{/profile/photo/delete}" 
                           onclick="return confirm('Er du sikker på, at du vil slette dit profilbillede?')"
                           class="btn-danger"
                           style="text-decoration: none; display: inline-block; padding: 10px 20px; background-color: #dc3545; color: white; border-radius: 4px;">
                            Slet billede
                        </a>
                        <a th:href="${user.role.name() == 'ADMIN' ? '/admin/dashboard' : '/svend/dashboard'}"
                            class="btn-secondary"
                            style="text-decoration: none; display: inline-block; padding: 10px 20px; background-color: #6c757d; color: white; border-radius: 4px;">
                            Tilbage til dashboard
                        </a>
                    </div>
                </form>
            </div>
        </main>
    </div>
</body>

</html>